<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Folkrörelser i Sverige – Quiz</title>
<style>
  :root{
    --bg:#0f172a; --card:#111827; --text:#e5e7eb; --muted:#9ca3af;
    --brand:#22c55e; --accent:#3b82f6; --wrong:#ef4444; --right:#10b981; --border:#1f2937;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
    background:linear-gradient(180deg,#0b1220 0%, #0f172a 35%, #0b1220 100%);
    color:var(--text);
  }
  .wrap{max-width:820px;margin:0 auto;padding:18px}
  header{display:flex;gap:12px;align-items:center;justify-content:space-between}
  h1{font-size:1.35rem;margin:0;font-weight:650}
  .card{
    background:var(--card); border:1px solid var(--border);
    border-radius:16px; padding:14px 14px; box-shadow:0 10px 30px rgba(0,0,0,.25);
  }
  .muted{color:var(--muted); font-size:.95rem}
  .controls{display:flex; gap:8px; flex-wrap:wrap; margin:10px 0 14px}
  button{
    background:var(--accent); border:none; color:white; padding:10px 14px; border-radius:10px;
    font-weight:600; cursor:pointer;
  }
  button.secondary{background:#374151}
  button.ghost{background:transparent; border:1px solid var(--border)}
  .q{
    margin:14px 0; padding:14px; border:1px solid var(--border); border-radius:12px; background:#0f1a33;
  }
  .q-head{display:flex;justify-content:space-between;gap:8px;align-items:flex-start}
  .q-title{font-weight:650;line-height:1.35}
  .badge{
    font-size:.75rem; padding:3px 8px; border-radius:999px; border:1px solid var(--border); color:var(--muted)
  }
  .opts{margin-top:10px; display:grid; gap:8px}
  .opt{
    display:flex; align-items:flex-start; gap:10px; padding:10px 12px; border:1px solid #1b2745; border-radius:10px;
    background:#0c1630; cursor:pointer;
  }
  .opt input{margin-top:3px}
  .opt.correct{border-color:rgba(16,185,129,.9); background:rgba(16,185,129,.06)}
  .opt.incorrect.selected{border-color:rgba(239,68,68,.9); background:rgba(239,68,68,.07)}
  .opt.missed{border-color:rgba(16,185,129,.65); border-style:dashed}
  .explain{
    margin-top:8px; font-size:.95rem; color:#cbd5e1; display:none
  }
  .q.result .explain{display:block}
  .score{
    margin-top:12px; padding:12px; border:1px dashed var(--border); border-radius:12px;
    background:#0b142b
  }
  .pill{
    display:inline-block; padding:2px 8px; border-radius:999px; border:1px solid var(--border); font-size:.8rem; color:#cbd5e1
  }
  .footer-note{margin-top:10px;color:var(--muted);font-size:.85rem}
  /* Tap targets */
  @media (hover:none){
    .opt{padding:14px}
    button{padding:12px 16px}
  }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>Folkrörelser i Sverige – Quiz</h1>
    <span class="pill" id="countPill"></span>
  </header>

  <div class="card">
    <p class="muted">
      Slumpmässiga frågor och slumpad svarordning. Vissa frågor är <b>flerval</b> (välj alla som stämmer).
      Tryck <i>Rätta</i> när du är klar.
    </p>
    <div class="controls">
      <button id="newSetBtn" class="secondary" title="Slumpa nya frågor">Ny omgång</button>
      <button id="checkBtn">Rätta</button>
      <button id="showAnswersBtn" class="ghost" title="Visa facit efter rättning">Visa facit</button>
      <button id="resetBtn" class="ghost">Rensa val</button>
    </div>
    <div id="quiz"></div>
    <div id="summary" class="score" style="display:none"></div>
    <div class="footer-note">Källa: texten i uppgiften om Arbetarrörelsen, LO, Kvinnorörelsen, Nykterhetsrörelsen och Frikyrkorörelsen.</div>
  </div>
</div>

<script>
/* --- Hjälpfunktioner --- */
const shuffle = arr => arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]);
const htmlEsc = s => s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");

/* --- Frågebank (endast uppgifter från given text) --- */
const BANK = [
  {
    t: "Vem spred socialistiska idéer på långa resor i Sverige?",
    type: "single",
    opts: [
      ["August Palm", 1],
      ["Ivan Bratt", 0],
      ["Peter Wieselgren", 0],
      ["Elin Wägner", 0],
      ["Hjalmar Branting", 0],
    ],
    exp: "August Palm reste runt och spred socialistiska idéer."
  },
  {
    t: "Vad hette dagstidningen som började ges ut 1885?",
    type: "single",
    opts: [
      ["Socialdemokraten", 1],
      ["Arbetet", 0],
      ["Folkviljan", 0],
      ["Ny Tid", 0],
      ["Framsteg", 0],
    ],
    exp: "År 1885 började Palm ge ut dagstidningen Socialdemokraten."
  },
  {
    t: "När grundades Sveriges socialdemokratiska arbetareparti?",
    type: "single",
    opts: [
      ["1889", 1],
      ["1885", 0],
      ["1898", 0],
      ["1905", 0],
      ["1917", 0],
    ],
    exp: "Fyra år efter 1885, alltså 1889, grundades partiet."
  },
  {
    t: "Vilket var ett av Kata Dalströms viktigaste krav?",
    type: "single",
    opts: [
      ["Rösträtt för alla", 1],
      ["Förbud mot folkomröstningar", 0],
      ["Avskaffa fackföreningar", 0],
      ["Återinföra ståndsriksdag", 0],
      ["Förbjuda tidningar", 0],
    ],
    exp: "Kata Dalström talade runt om i landet med kravet rösträtt för alla."
  },
  {
    t: "Vad är LO i texten?",
    type: "single",
    opts: [
      ["En gemensam organisation för fackförbund inom arbetaryrken", 1],
      ["Ett politiskt parti", 0],
      ["En internationell nykterhetsrörelse", 0],
      ["En frikyrka", 0],
      ["En dagstidning", 0],
    ],
    exp: "LO var (är) paraplyorganisationen för fackförbunden."
  },
  {
    t: "Hur organiserade sig arbetare fackligt enligt texten?",
    type: "single",
    opts: [
      ["Efter yrke i fackföreningar", 1],
      ["Efter bostadsort i byalag", 0],
      ["Efter ålder i åldersråd", 0],
      ["Efter kön i könsråd", 0],
      ["Efter religion i samfund", 0],
    ],
    exp: "Arbetare samlades i fackföreningar efter yrke (t.ex. Målareförbundet)."
  },
  {
    t: "Vilket årtal förknippas med storstrejken enligt texten?",
    type: "single",
    opts: [
      ["1909", 1],
      ["1917", 0],
      ["1922", 0],
      ["1898", 0],
      ["1900", 0],
    ],
    exp: "Storstrejken som flera fackförbund var engagerade i var 1909."
  },
  {
    t: "Vad ville kvinnorörelsen uppnå enligt texten?",
    type: "multi",
    opts: [
      ["Samma rätt till arbete", 1],
      ["Samma rätt till utbildning", 1],
      ["Samma ekonomiska rättigheter", 1],
      ["Avskaffa rösträtten för män", 0],
      ["Införa våldsamma metoder", 0],
    ],
    exp: "Målet var lika rätt till arbete, utbildning och ekonomi."
  },
  {
    t: "När blev rösträttsfrågan kvinnorörelsens absolut viktigaste fråga?",
    type: "single",
    opts: [
      ["Från 1900", 1],
      ["Från 1845", 0],
      ["Från 1885", 0],
      ["Från 1917", 0],
      ["Från 1922", 0],
    ],
    exp: "Texten anger att från 1900 var rösträtt den viktigaste frågan."
  },
  {
    t: "Vilka metoder använde kvinnorörelsen enligt texten?",
    type: "multi",
    opts: [
      ["Föredrag runt om i landet", 1],
      ["Kurser", 1],
      ["Studiecirklar", 1],
      ["Våldsam aktivism", 0],
      ["Hungerblockader vid hamnar", 0],
    ],
    exp: "De tog avstånd från våld och ordnade föredrag, kurser och studiecirklar."
  },
  {
    t: "Vilka av följande personer nämns i texten i anslutning till kvinnorörelsen?",
    type: "multi",
    opts: [
      ["Ellen Key", 1],
      ["Selma Lagerlöf", 1],
      ["Elin Wägner", 1],
      ["Else Kleen", 1],
      ["Alva Myrdal", 0],
    ],
    exp: "Nämnda: Ellen Key, Selma Lagerlöf, Elin Wägner, Else Kleen (och Klara Johansson)."
  },
  {
    t: "Hur många namnunderskrifter för kvinnlig rösträtt visas med Elin Wägner 1913–1914?",
    type: "single",
    opts: [
      ["Mer än 350 000", 1],
      ["Cirka 35 000", 0],
      ["Exakt 300 000", 0],
      ["Mindre än 50 000", 0],
      ["Mer än 1 miljon", 0],
    ],
    exp: "Fotot visar över 350 000 insamlade namn."
  },
  {
    t: "Vad engagerade sig Elin Wägner i enligt texten?",
    type: "multi",
    opts: [
      ["Kvinnors och barns rättigheter", 1],
      ["Grundandet av Rädda Barnen", 1],
      ["Fredsfrågor", 1],
      ["Miljöfrågor", 1],
      ["Monarkistisk propaganda", 0],
    ],
    exp: "Hon drev frågor om kvinnor/barn, var med och grundade Rädda Barnen, samt fred och miljö."
  },
  {
    t: "Fram till vilket år var husbehovsbränning av brännvin tillåten?",
    type: "single",
    opts: [
      ["1855", 1],
      ["1845", 0],
      ["1870", 0],
      ["1917", 0],
      ["1922", 0],
    ],
    exp: "Husbehovsbränning var tillåten fram till 1855."
  },
  {
    t: "Vad manade de tidiga nykterhetsföreningarna (Wieselgrens linje) till?",
    type: "single",
    opts: [
      ["Måttlighet i bruket av brännvin", 1],
      ["Total avhållsamhet från start", 0],
      ["Fri försäljning av sprit", 0],
      ["Enbart vin till måltid", 0],
      ["Förbud mot kaffe", 0],
    ],
    exp: "De första föreningarna krävde inte total avhållsamhet, utan måttlighet."
  },
  {
    t: "Vilka organisationer gav nykterhetsrörelsen ett nytt uppsving på 1870-talet?",
    type: "multi",
    opts: [
      ["IOGT", 1],
      ["NTO", 1],
      ["LO", 0],
      ["SAF", 0],
      ["KF", 0],
    ],
    exp: "IOGT och NTO spred idéerna internationellt och i Sverige."
  },
  {
    t: "Vad innebar motbokssystemet som infördes 1917?",
    type: "multi",
    opts: [
      ["Män över 25 år: högst 4 liter sprit/månad", 1],
      ["Gifta kvinnor: ingen rätt att köpa sprit", 1],
      ["Ogifta kvinnor 25+: kunde ansöka om mindre mängd", 1],
      ["Systemet gällde bara vin", 0],
      ["Systemet fanns kvar till 1965", 0],
    ],
    exp: "Begränsningar enligt texten; systemet gällde till 1955 (inte 1965)."
  },
  {
    t: "När upphörde motbokssystemet?",
    type: "single",
    opts: [
      ["1955", 1],
      ["1922", 0],
      ["1917", 0],
      ["1939", 0],
      ["1965", 0],
    ],
    exp: "Motboken fanns kvar till 1955."
  },
  {
    t: "Vad blev resultatet av folkomröstningen 1922 om alkohol?",
    type: "single",
    opts: [
      ["Förbud förlorade med 49–51 → alkohol fick säljas", 1],
      ["Förbud vann med 60–40 → alkohol förbjöds", 0],
      ["Oavgjort → ny omröstning 1923", 0],
      ["Endast öl förbjöds", 0],
      ["Endast vin förbjöds", 0],
    ],
    exp: "Förbudssidan förlorade knappt; alkohol fick fortsatt säljas."
  },
  {
    t: "Vad ville frikyrkorörelsen uppnå enligt texten?",
    type: "multi",
    opts: [
      ["Själv tolka Bibeln", 1],
      ["Fritt få samlas till gudstjänst", 1],
      ["Lämna statskyrkan", 1],
      ["Införa statlig censur av predikningar", 0],
      ["Förbjuda musik i kyrkor", 0],
    ],
    exp: "Målet var egen bibeltolkning och fri samling; många lämnade statskyrkan."
  },
  {
    t: "Vad var förbjudet fram till 1858 enligt texten?",
    type: "single",
    opts: [
      ["Att samlas i hemmen för gudstjänst", 1],
      ["Att läsa Bibeln privat", 0],
      ["Att skriva tidningar", 0],
      ["Att byta församling", 0],
      ["Att ge allmosor", 0],
    ],
    exp: "Fram till 1858 var gudstjänst i hemmen förbjuden."
  },
  {
    t: "Vilka av följande är frikyrkor som nämns i texten?",
    type: "multi",
    opts: [
      ["Metodistkyrkan", 1],
      ["Baptistsamfundet", 1],
      ["Missionsförbundet", 1],
      ["Svenska kyrkan", 0],
      ["Pingströrelsen", 0],
    ],
    exp: "Exemplen i texten: Metodistkyrkan, Baptistsamfundet, Missionsförbundet."
  },
  {
    t: "Vilka spår nämns av frikyrkornas roll i industrisamhällena?",
    type: "multi",
    opts: [
      ["De skapade gemenskap", 1],
      ["De blev en skola i demokrati", 1],
      ["De införde ransonering av sprit", 0],
      ["De styrde kommunalvalen", 0],
      ["De ersatte statskyrkan formellt 1858", 0],
    ],
    exp: "Texten lyfter gemenskap och ”skola i demokrati”."
  }
];

/* --- Inställningar --- */
const QUESTIONS_PER_SET = 12;  // antal slumpade frågor per omgång

/* --- Render & logik --- */
let CURRENT = [];

function pickSet(){
  CURRENT = shuffle(BANK).slice(0, QUESTIONS_PER_SET).map((q, idx) => {
    const id = `q${Date.now()}_${idx}`;
    return {...q, id, opts: shuffle(q.opts.slice())};
  });
}

function render(){
  const quiz = document.getElementById('quiz');
  quiz.innerHTML = '';
  CURRENT.forEach((q, i) => {
    const isMulti = q.type === 'multi';
    const qEl = document.createElement('div');
    qEl.className = 'q';
    qEl.dataset.qid = q.id;

    const head = document.createElement('div');
    head.className = 'q-head';

    const title = document.createElement('div');
    title.className = 'q-title';
    title.innerHTML = `<span class="badge">Fråga ${i+1}</span> ${htmlEsc(q.t)}`;

    const mode = document.createElement('span');
    mode.className = 'badge';
    mode.textContent = isMulti ? 'Flerval' : 'Enval';

    head.appendChild(title);
    head.appendChild(mode);

    const opts = document.createElement('div');
    opts.className = 'opts';

    q.opts.forEach((opt, j) => {
      const [text, correct] = opt;
      const optId = `${q.id}_o${j}`;
      const label = document.createElement('label');
      label.className = 'opt';
      label.htmlFor = optId;

      const input = document.createElement('input');
      input.type = isMulti ? 'checkbox' : 'radio';
      input.name = q.id;
      input.id = optId;
      input.value = j;

      const span = document.createElement('span');
      span.innerHTML = htmlEsc(text);

      label.appendChild(input);
      label.appendChild(span);
      label.addEventListener('click', (e) => {
        // Gör hela ytan klickbar utan att dubbel-togglea checkboxar
        if(e.target.tagName.toLowerCase() !== 'input'){
          input.checked = !input.checked;
          if(!isMulti){
            // avmarkera andra om enval
            opts.querySelectorAll('input').forEach(inp => { if(inp!==input) inp.checked=false; });
          }
          e.preventDefault();
        }
      });

      opts.appendChild(label);
    });

    const explain = document.createElement('div');
    explain.className = 'explain';
    explain.textContent = q.exp;

    qEl.appendChild(head);
    qEl.appendChild(opts);
    qEl.appendChild(explain);
    quiz.appendChild(qEl);
  });

  document.getElementById('countPill').textContent = `${CURRENT.length} frågor`;
  document.getElementById('summary').style.display = 'none';
}

function grade(showAnswers=false){
  let right=0, total=0;
  CURRENT.forEach(q => {
    total += 1;
    const qEl = document.querySelector(`.q[data-qid="${q.id}"]`);
    const inputs = Array.from(qEl.querySelectorAll('input'));
    const chosen = new Set(inputs.filter(i=>i.checked).map(i=>+i.value));
    const correctIdx = new Set(q.opts.map((o,idx)=> o[1] ? idx : -1).filter(x=>x>=0));
    const isCorrect = chosen.size===correctIdx.size && [...chosen].every(v=>correctIdx.has(v));

    // reset classes
    qEl.querySelectorAll('.opt').forEach(o => o.classList.remove('correct','incorrect','missed','selected'));
    // annotate if showAnswers or after check
    inputs.forEach((inp, idx) => {
      const label = inp.closest('.opt');
      if(inp.checked) label.classList.add('selected');
      if(showAnswers){
        if(q.opts[idx][1] && inp.checked) label.classList.add('correct');
        if(!q.opts[idx][1] && inp.checked) label.classList.add('incorrect');
        if(q.opts[idx][1] && !inp.checked) label.classList.add('missed');
      }
    });

    if(isCorrect) right += 1;
    qEl.classList.add('result');
  });

  const sum = document.getElementById('summary');
  const pct = Math.round(100*right/total);
  sum.style.display = 'block';
  sum.innerHTML = `
    <div><b>Resultat:</b> ${right} av ${total} rätt (${pct}%).</div>
    <div class="muted" style="margin-top:6px">
      Grönt = rätt valt • Röd = felvalt • Grön streckad ram = korrekt svar som missades.
    </div>
  `;
}

function clearSelections(){
  document.querySelectorAll('#quiz input').forEach(i => i.checked=false);
  document.querySelectorAll('.opt').forEach(o => o.classList.remove('correct','incorrect','missed','selected'));
  document.getElementById('summary').style.display = 'none';
  document.querySelectorAll('.q').forEach(q => q.classList.remove('result'));
}

/* --- Init --- */
function newRound(){
  pickSet();
  render();
}

document.getElementById('newSetBtn').addEventListener('click', () => newRound());
document.getElementById('checkBtn').addEventListener('click', () => grade(true));
document.getElementById('showAnswersBtn').addEventListener('click', () => grade(true));
document.getElementById('resetBtn').addEventListener('click', () => clearSelections());

// Första start
newRound();
</script>
</body>
</html>
